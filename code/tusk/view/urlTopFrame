<%args>
	$summary		=> 0
	$SIZE			=> ''
	$OVERLAY		=> 0
</%args>

<%attr>
	top_tab_type            => 'none'
	displayLittleUserNavBar => '1'
	default_path_type	=> 'content'
	allow_guests		=> '1'
	no_body			=> '0'
</%attr>

<%shared>
	my $document = $m->comp('/tmpl/url:get_type_object');
        my $iconWidth = 27;
        my $printIconWidth = "width=\"$iconWidth\" height=\"$iconWidth\"";
	my $imageDir = "/graphics";
	my $userObject = $m->session->{'user'}; #HSDB4::SQLRow::User->new->lookup_key($m->session->{'user'});
	my $iCanEdit = $document->can_user_edit($userObject);
</%shared>

<%method startup>
<%args>
$args => {}
</%args>
  <%perl>
    $m->comp("SELF:set_no_cache");
  </%perl>
</%method>

<%method title>
%	return ucfirst($document->type) .": ". $document->out_label;
</%method>

<%doc>Redirect if we are not url</%doc>
% unless($document->display_framed) {
%	my $location = $ENV{SCRIPT_URI};
%	$location =~ s/view\/url/view\/content/;
%	$r->header_out(Location => $location);
%	$r->status('REDIRECT');
%	exit;
% }


% unless($iCanEdit || $document->is_active()) {
	<br><br>
	<table border="0" width="100%">
	  <tr><th><font size="+2">Sorry this content is not currently active.</font></th></tr>
	</table>
	<br><br>
%    return();
% }

% if($iCanEdit && !$document->is_active()) {
	<div style="border:2px solid red;font-size:14px; margin-top:2px; margin-bottom:0px;"><center>This content has expired!<br>You can only see the content because you are an author.</center></div>
% }


<div id="tuskbar" style="position:absolute; top:5px; left:50%; height: <% $iconWidth %>px; width:<% 3 * $iconWidth %>px; border:1px solid black; z-index:9999;">
  <table border="0" cellspacing="0" cellpadding="0" width="100%">
    <tr>
      <td align="right" width="<% ($iconWidth+2) %>" valign="middle">
%       my $prev = $document->context_prev;
%       my $title = "Previous Document";
%       my $background = 'style="background-color:lightgrey;"';
%       if($prev) {
%         $title.= ": " . $prev->out_abbrev();
%         $background = "onClick=\"parent.location='" . $prev->out_url() .
%                       "';\" onMouseOver=\"highlightButton(this);\" onMouseOut=\"removeHighlighting(this);\"";
%       }
        <img src="<% $imageDir %>/previous.gif" title="<% $title %>" <% $background %> <% $printIconWidth %> alt="Previous">
      </td>
      <td align="right" width="<% ($iconWidth+2) %>" valign="middle">
%       my $collection = $document->context_parent;
%       $title = "To Collection";
%       $background = 'style="background-color: lightgrey;"';
%       if($collection) {
%         $title.= ": " . $collection->out_abbrev();
%         $background = "onClick=\"parent.location='" . $collection->out_url() .
%                       "';\" onMouseOver=\"highlightButton(this);\" onMouseOut=\"removeHighlighting(this)\";"
%       }
        <img src="<% $imageDir %>/content_up.gif" <% $printIconWidth %> title="<% $title %>" <% $background %> alt="To Collection">
      </td>
      <td align="right" width="<% ($iconWidth+2) %>" valign="middle">
%       my $next = $document->context_next;
%       $title = "Next Document";
%       $background = 'style="background-color: lightgrey;"';
%       if($next) {
%         $title.= ": " . $next->out_abbrev();
%         $background = "onClick=\"parent.location='" . $next->out_url() .
%                       "';\" onMouseOver=\"highlightButton(this);\" onMouseOut=\"removeHighlighting(this)\";"
%       }
        <img src="<% $imageDir %>/next.gif" <% $printIconWidth %> title="<% $title %>" <% $background %> alt="Next">
      </td>
    </tr>
  </table>
</div>

<%method red_header_class>
%	return 'blueHeaderBar';
</%method>

<%method red_header_text>
%	return "<b>" . $document->out_label . "</b>";
</%method>

<%method right_header_text>
<%doc>Method that returns a list of all the images to use to the right on the red header bar</%doc>
<%perl>

my $right_hdr_lnks = [];

if($iCanEdit){
	my $edit_lnk = $m->comp('/tmpl/url:get_edit_link', content => $document, target => '_top');
	push @$right_hdr_lnks, $edit_lnk;
}

return $right_hdr_lnks;


</%perl>
</%method>
