<%method edit_PersonalContentCollection>
  <%args>
    $personalContentRef
	$lngth
	$i
  </%args>

% if ( ${$personalContentRef}->field_value("type") ne "Flash Card Deck" ) {

<tr height="10px"> </tr>
  <tr bgcolor="#cccccc"  >

	<td>  
<select name="order_box" onchange="this.form.order.value=this.options[this.selectedIndex].value;this.form.submit();">
% for (my $j=1; $j< $lngth+1; $j++) {

%if ($i == $j) { 
	<option selected="" value=""  >

% } else {
	<option value="<% $i %>-<% $j %>" >
% } 
 
<% $j %> </option>

% }  #end for loop

</select>

</td>
    <td ><img src="/icons/ico-folder-openminus.gif" id="fldr_<% $i %>" width="20" height="22" border="0" onclick="javascript:toggle_visibility_multiple('toggled<% $i %>');toggle_img(<% $i %>);">
</td>
    <td colspan="3" align="left">
      <input class="textareawhite" name="rename_<% ${$personalContentRef}->primary_key %>" type="text" size="40" value="<% ${$personalContentRef}->out_label %>" >


<a class="navsm" href="javascript:submitrename('pcform',<% ${$personalContentRef}->primary_key %>)">Save Name</a> |
<a class="navsm" href="javascript:submitnote('pcform',<% ${$personalContentRef}->primary_key %>)">Add Note</a>
     
    </td>
    <td align="right">

<a class="navsm" href="javascript:submitformpc(<% ${$personalContentRef}->primary_key %>, 0);" >Delete Folder</a> 
</td>
  </tr>
<tr> <td colspan="6">
<table width = 100%> <!-- -->
% foreach my $doc (${$personalContentRef}->active_child_content()) {

  <tr id ="toggled<% $i %>" width = 100%>
    <td>&nbsp;</td>
    <td align="center"><% $doc->out_html_thumbnail %></td>
    <td><% $doc->out_html_label %></td>
    <td><% join ("; ", map { $_->out_abbrev } $doc->child_users) %></td>
	<td></td>
    <td align="right">

<a class="navsm" href="javascript:submitformpc(<% ${$personalContentRef}->primary_key %>,<% $doc->primary_key %>);" >Delete</a>  

</td>
  </tr> <!-- toggled -->
%   foreach($doc->child_personal_content(${$personalContentRef}->field_value('user_id'))) {
      <tr id ="toggled<% $i %>" width = 100%>
        <td colspan="2">&nbsp;</td>
        <td>
%     foreach my $l (split /[\cA-\cZ]{2}/, $_->field_value('body')) {
          <div class="docinfo"><i><% $l %></i></div>
%     }
        </td>
        <td colspan="3">&nbsp;</td>
      </tr>
%   }
% }

% } # end if its not a flash card deck

</table>

  <%perl>
	if ( ${$personalContentRef}->field_value("type") ne "Flash Card Deck" ) {

    	foreach my $pc (${$personalContentRef}->child_personal_content) {
      	if($pc->can('out_html_edit'))
        	{ 
			$m->comp("SELF:edit_PersonalContent", personalContentRef => \$pc, parentContentID => ${$personalContentRef}->primary_key, i => $i);}
      	else
        	{$pc->out_html_row;}
    	}
	}
  </%perl>


</td></tr>

</%method>

% ##############################################################################################################

<%method edit_PersonalContentCollectionDeck>
  <%args>
    $personalContentRef
	$i
	$lngth
  </%args>


<tr height="10px"> </tr>
<tr bgcolor="#cccccc">

<td>  
<select name="order_box" onchange="this.form.order.value=this.options[this.selectedIndex].value;this.form.submit();">
% for (my $j=1; $j< $lngth+1; $j++) {

%if ($i == $j) { 
	<option selected="" value=""  >

% } else {
	<option value="<% $i %>-<% $j %>" >
% } 
 
<% $j %> </option>

% }  #end for loop

</select>

</td><td>

<img src="/icons/ico-folder-openminus.gif" id="fldr_<% $i %>" width="20" height="22" border="0" onclick="javascript:toggle_visibility_multiple('toggled<% $i %>');toggle_img(<% $i %>);">
</td>

    <td colspan="3" align="left">
      <input class="textareawhite" name="rename_<% ${$personalContentRef}->primary_key %>" type="text" size="40" value="<% ${$personalContentRef}->out_label %>"  >
   
      <a class="navsm" href="javascript:submitrename('fcardform',<% ${$personalContentRef}->primary_key %>)">Save Name</a> 
    </td>
    <td align="right">

<a class="navsm" href="/management/flashcard/newblankcard/<% ${$personalContentRef}->primary_key %>/blank">New Blank Card</a> |
<a class="navsm" href="/management/flashcard/viewdeck/<% ${$personalContentRef}->primary_key %>">Test Yourself</a> | 
<a class="navsm" href="javascript:submitform(<% ${$personalContentRef}->primary_key %>, 1);" >Delete Deck</a> 

</td>
 </tr>


% #####   Begin: Get cards in this deck, show them
% my $cards = TUSK::FlashCard->lookup("parent_personal_content_id = ".${$personalContentRef}->primary_key);


<tr id ="toggled<% $i %>1"  >
<td colspan="100%">
<& /tmpl/element:object_selection_box, params => { 
	sort_box => 0,
	columns => [ 
		{'label' => 'Thumb', 'field' => 'outCardThumbnail', align => 'left', width => '15%'},
		{'label' => 'title', 'field' => 'outCardTitle', align => 'left', width => '35%'},
		{'label' => 'Owner', 'field' => 'outCardOwner', align => 'left', width => '25%'}, 
	],
	action_columns => [ 
		{ 'label' =>'Modify','link' => '/management/flashcard/editcard' },
		{ 'label' => 'Delete','link' => '/management/flashcard/deletecard' },
	],
	type_path => '',
	action_column_align => 'right',
	object_list => $cards,
	name => "cards",
	no_header => 1,
} &>
</td>
</tr>

% ##### End : Get cards in this deck, show them

</%method>


% #########################################################################################################

<%method edit_PersonalContent>
  <%args>
    $personalContentRef
    $parentContentID
	$i
  </%args>

  <tr valign="top" id ="toggled<% $i %>">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td Valign="top" align="right">
      <textarea name="rename_<% ${$personalContentRef}->primary_key %>" class="textareawhite" cols="60" wrap="virtual" rows="4"><% ${$personalContentRef}->field_value('body') %></textarea>
    </td>
    <td align="left" valign="top"><input type="submit" value="Save Note" class="formbutton"></td>
    <td align="right" valign="top" colspan="2"><input type="submit" name="deletePersonalContent_<% $parentContentID %>.<% ${$personalContentRef}->primary_key %>" value="Delete" class="formbutton"</td>
   </tr>
   
</%method>
